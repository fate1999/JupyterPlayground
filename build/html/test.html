<!DOCTYPE html>
<html class="writer-html5" lang="English" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; JupyterRTD_test  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            JupyterRTD_test
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul class="simple">
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">JupyterRTD_test</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/test.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <dl>
<dt>{</dt><dd><dl>
<dt>&quot;cells&quot;: [</dt><dd><dl>
<dt>{</dt><dd><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 11,
&quot;id&quot;: &quot;b2c2f227&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;import torchn&quot;,
&quot;# test&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 12,
&quot;id&quot;: &quot;2455656f&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;Falsen&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;print(torch.cuda.is_available())&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 13,
&quot;id&quot;: &quot;7c91ba98&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;cpun&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;x = torch.tensor([1,2,3], device=&quot;cpu&quot;)n&quot;,
&quot;print(x.device)&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 14,
&quot;id&quot;: &quot;3316aee8&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>&quot;data&quot;: {</dt><dd><dl class="simple">
<dt>&quot;text/plain&quot;: [</dt><dd><p>&quot;tensor([1, 2, 3])&quot;</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
&quot;execution_count&quot;: 14,
&quot;metadata&quot;: {},
&quot;output_type&quot;: &quot;execute_result&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;x&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 15,
&quot;id&quot;: &quot;e83445ed&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;Using torch 1.12.1n&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;print(&quot;Using torch&quot;, torch.__version__)&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 16,
&quot;id&quot;: &quot;63f6f4c2&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;0n&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;print(torch.cuda.device_count())&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 17,
&quot;id&quot;: &quot;3e2b5718&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;# print(torch.cuda.get_device_name(0))&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;attachments&quot;: {},
&quot;cell_type&quot;: &quot;markdown&quot;,
&quot;id&quot;: &quot;5d41a651&quot;,
&quot;metadata&quot;: {},
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;Real Test&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 18,
&quot;id&quot;: &quot;e35e66ab&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>&quot;data&quot;: {</dt><dd><dl class="simple">
<dt>&quot;text/plain&quot;: [</dt><dd><p>&quot;(11, 1)&quot;</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
&quot;execution_count&quot;: 18,
&quot;metadata&quot;: {},
&quot;output_type&quot;: &quot;execute_result&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;import numpy as npn&quot;,
&quot;x_values = [i for i in range(11)]n&quot;,
&quot;x_train = np.array(x_values, dtype = np.float32)n&quot;,
&quot;x_train = x_train.reshape(-1,1)n&quot;,
&quot;x_train.shape&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 19,
&quot;id&quot;: &quot;d79b3874&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>&quot;data&quot;: {</dt><dd><dl class="simple">
<dt>&quot;text/plain&quot;: [</dt><dd><p>&quot;(11, 1)&quot;</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
&quot;execution_count&quot;: 19,
&quot;metadata&quot;: {},
&quot;output_type&quot;: &quot;execute_result&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;y_values = [2*i + 1 for i in x_values]n&quot;,
&quot;y_train = np.array(y_values, dtype=np.float32)n&quot;,
&quot;y_train = y_train.reshape(-1, 1)n&quot;,
&quot;y_train.shape&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 20,
&quot;id&quot;: &quot;29ec468a&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;import torch.nn as nn&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 21,
&quot;id&quot;: &quot;72a0dfc8&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;class LinearRegressionModel(nn.Module):n&quot;,
&quot;    def __init__(self, input_dim, output_dim):n&quot;,
&quot;        super(LinearRegressionModel, self).__init__()n&quot;,
&quot;        self.linear = nn.Linear(input_dim, output_dim)n&quot;,
&quot;n&quot;,
&quot;    def forward(self, x):n&quot;,
&quot;        out = self.linear(x)n&quot;,
&quot;        return out&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 22,
&quot;id&quot;: &quot;d2398b7b&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;input_dim = 1n&quot;,
&quot;output_dim = 1n&quot;,
&quot;model = LinearRegressionModel(input_dim, output_dim)&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;attachments&quot;: {},
&quot;cell_type&quot;: &quot;markdown&quot;,
&quot;id&quot;: &quot;855badc5&quot;,
&quot;metadata&quot;: {},
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;Send to cuda&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 23,
&quot;id&quot;: &quot;1d10b061&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>&quot;data&quot;: {</dt><dd><dl class="simple">
<dt>&quot;text/plain&quot;: [</dt><dd><p>&quot;LinearRegressionModel(n&quot;,
&quot;  (linear): Linear(in_features=1, out_features=1, bias=True)n&quot;,
&quot;)&quot;</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
&quot;execution_count&quot;: 23,
&quot;metadata&quot;: {},
&quot;output_type&quot;: &quot;execute_result&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;device = torch.device(&quot;cuda:0&quot; if torch.cuda.is_available() else &quot;cpu&quot;)n&quot;,
&quot;model.to(device)&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 24,
&quot;id&quot;: &quot;f6509d2b&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;epochs = 1000n&quot;,
&quot;learning_rate = 0.01n&quot;,
&quot;optimizer = torch.optim.SGD(model.parameters(), lr=learning_rate)n&quot;,
&quot;criterion = nn.MSELoss()&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 25,
&quot;id&quot;: &quot;b23db1a9&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;epoch 50, loss 0.008630900643765926n&quot;,
&quot;epoch 100, loss 0.004922772757709026n&quot;,
&quot;epoch 150, loss 0.002807763172313571n&quot;,
&quot;epoch 200, loss 0.001601436990313232n&quot;,
&quot;epoch 250, loss 0.0009133908315561712n&quot;,
&quot;epoch 300, loss 0.0005209620576351881n&quot;,
&quot;epoch 350, loss 0.00029714530683122575n&quot;,
&quot;epoch 400, loss 0.00016948148550000042n&quot;,
&quot;epoch 450, loss 9.666730329627171e-05n&quot;,
&quot;epoch 500, loss 5.51330522284843e-05n&quot;,
&quot;epoch 550, loss 3.1446139473700896e-05n&quot;,
&quot;epoch 600, loss 1.7933869457920082e-05n&quot;,
&quot;epoch 650, loss 1.0230058251181617e-05n&quot;,
&quot;epoch 700, loss 5.835618139826693e-06n&quot;,
&quot;epoch 750, loss 3.329520495753968e-06n&quot;,
&quot;epoch 800, loss 1.8985450651598512e-06n&quot;,
&quot;epoch 850, loss 1.0828505310200853e-06n&quot;,
&quot;epoch 900, loss 6.178506168907916e-07n&quot;</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>&quot;name&quot;: &quot;stdout&quot;,
&quot;output_type&quot;: &quot;stream&quot;,
&quot;text&quot;: [</p>
<blockquote>
<div><p>&quot;epoch 950, loss 3.5266614872853097e-07n&quot;,
&quot;epoch 1000, loss 2.0096017294690682e-07n&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;for epoch in range(epochs):n&quot;,
&quot;    epoch += 1n&quot;,
&quot;n&quot;,
&quot;    # .to(device) send to cudan&quot;,
&quot;    inputs = torch.from_numpy(x_train).to(device)n&quot;,
&quot;    labels = torch.from_numpy(y_train).to(device)n&quot;,
&quot;n&quot;,
&quot;    optimizer.zero_grad()n&quot;,
&quot;    outputs = model(inputs)n&quot;,
&quot;    loss = criterion(outputs, labels)n&quot;,
&quot;n&quot;,
&quot;    loss.backward()n&quot;,
&quot;    optimizer.step()n&quot;,
&quot;    if epoch % 50 == 0:n&quot;,
&quot;        print('epoch {}, loss {}'.format(epoch, loss.item()))&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 26,
&quot;id&quot;: &quot;0484b14c&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;# predicted = model(torch.from_numpy(x_train).requires_grad_()).data.numpy()n&quot;,
&quot;# predicted&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 27,
&quot;id&quot;: &quot;af1c4f3d&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;torch.save(model.state_dict(), 'model.pkl')&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>&quot;cell_type&quot;: &quot;code&quot;,
&quot;execution_count&quot;: 28,
&quot;id&quot;: &quot;6148ebb8&quot;,
&quot;metadata&quot;: {},
&quot;outputs&quot;: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>&quot;data&quot;: {</dt><dd><dl class="simple">
<dt>&quot;text/plain&quot;: [</dt><dd><p>&quot;&lt;All keys matched successfully&gt;&quot;</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>},
&quot;execution_count&quot;: 28,
&quot;metadata&quot;: {},
&quot;output_type&quot;: &quot;execute_result&quot;</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
&quot;source&quot;: [</p>
<blockquote>
<div><p>&quot;model.load_state_dict(torch.load('model.pkl'))&quot;</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
&quot;metadata&quot;: {</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;kernelspec&quot;: {</dt><dd><p>&quot;display_name&quot;: &quot;Python 3 (ipykernel)&quot;,
&quot;language&quot;: &quot;python&quot;,
&quot;name&quot;: &quot;python3&quot;</p>
</dd>
</dl>
<p>},
&quot;language_info&quot;: {</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;codemirror_mode&quot;: {</dt><dd><p>&quot;name&quot;: &quot;ipython&quot;,
&quot;version&quot;: 3</p>
</dd>
</dl>
<p>},
&quot;file_extension&quot;: &quot;.py&quot;,
&quot;mimetype&quot;: &quot;text/x-python&quot;,
&quot;name&quot;: &quot;python&quot;,
&quot;nbconvert_exporter&quot;: &quot;python&quot;,
&quot;pygments_lexer&quot;: &quot;ipython3&quot;,
&quot;version&quot;: &quot;3.9.16&quot;</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
&quot;nbformat&quot;: 4,
&quot;nbformat_minor&quot;: 5</p>
</dd>
</dl>
<p>}</p>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Haodong.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>